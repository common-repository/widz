jQuery(function(e){"use strict";e.fn.widzWidget=function(){e(document).on("click",".widget-control-save",function(t){var i=e(this);if(!i.hasClass("trigger")){var d=i.closest(".widget").attr("id"),n=e("#"+d+" input.id_base").val();if("widz_tabbed_widget"==n){var a={},s=[];return e("#"+d+" .widz-widget-selected .widz-widget-item").each(function(){var t=e(this),i=t.attr("id"),d=e("#"+i+" .js-heading-text").text(),n=e("#"+i+" input, #"+i+" select, #"+i+" textarea").serializeArray(),l={};e.each(n,function(e,t){var i=t.name.split("][");2==i.length&&(i=i[1].replace("]",""),l[i]="on"==t.value?!0:t.value)}),("undefined"==typeof l.title||""==e.trim(l.title))&&(l.title=d),s.push(l.title);var o={widget_id:t.attr("data-widget_id"),number:t.attr("data-number"),widget:t.attr("data-widget"),params:l};a[o.widget_id+"-"+o.number]=o}),e("#"+d+" .widz-widget input.widz_value").val(JSON.stringify(a)),i.addClass("trigger"),setTimeout(function(){i.trigger("click")},200),t.stopPropagation(),!1}}i.removeClass("trigger"),t.preventDefault()}),e(document).on("click",".widz-widget .cmd.edit, .widz-widget .widz-widget-title h4",function(t){var i=e(this).closest(".widz-widget");i.hasClass("open")?i.find(".widz-widget-inside").slideUp({complete:function(){i.removeClass("open")}}):i.find(".widz-widget-inside").slideDown({complete:function(){i.addClass("open")}}),t.preventDefault()}),e(document).on("click",".widz-widget .cmd.remove",function(t){e(this).closest("li").addClass("removing").fadeOut("normal",function(){e(this).remove()}),t.preventDefault()}),e(document).on("change",".widz-widget-controls select",function(t){var i=e(this);""!=i.val()&&e.ajax({url:ajaxurl,type:"POST",data:{action:"widz_get_widget_control",widget_id:i.val(),widget_name:i.find("option:selected").text(),widget:i.find("option:selected").attr("data-widget")},beforeSend:function(){i.next(".spinner").show()},success:function(e){i.closest(".widz-widget").find("ul").append(e),i.next(".spinner").hide(),i.val("");var t=i.closest(".widz-widget").find("ul li.widz-widget-item:last-child"),d=t.find(".widz-icon_picker select");d.fontIconPicker(),t.find(".widz-widget-inside").slideDown({complete:function(){t.addClass("open")}})}}),t.preventDefault()}),e.fn.sortable&&e(".widz-widget-selected").sortable({items:".widz-widget-item",handle:".widz-widget-title h4",cancel:".widz-widget-title-action"})}});
